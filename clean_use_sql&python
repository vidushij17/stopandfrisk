import pandas as pd
import sqlite3

conn = sqlite3.connect('stop_and_frisk.db')

#  Define your SQL query: I asked and looked through the data and found this columns to be the most useful for us in what we can use to model
query = """
SELECT 
    SUSPECT_REPORTED_AGE, SUSPECT_SEX, SUSPECT_RACE_DESCRIPTION,
    SUSPECT_HEIGHT, SUSPECT_WEIGHT, SUSPECT_BODY_BUILD_TYPE,
    STOP_LOCATION_PRECINCT, STOP_LOCATION_BORO_NAME,
    STOP_LOCATION_PATROL_BORO_NAME,
    SUSPECT_ARRESTED_FLAG, SUSPECT_ARREST_OFFENSE,
    SUMMONS_ISSUED_FLAG, FRISKED_FLAG, SEARCHED_FLAG,
    OFFICER_EXPLAINED_STOP_FLAG,
    SUSPECTS_ACTIONS_CASING_FLAG,
    SUSPECTS_ACTIONS_CONCEALED_POSSESSION_WEAPON_FLAG,
    SUSPECTS_ACTIONS_DRUG_TRANSACTIONS_FLAG,
    SUSPECTS_ACTIONS_PROXIMITY_TO_SCENE_FLAG,
    BACKROUND_CIRCUMSTANCES_VIOLENT_CRIME_FLAG,
    BACKROUND_CIRCUMSTANCES_SUSPECT_KNOWN_TO_CARRY_WEAPON_FLAG,
    STOP_FRISK_DATE, STOP_FRISK_TIME,
    OFFICER_IN_UNIFORM_FLAG
FROM stop_and_frisk;
"""


df = pd.read_sql_query(query, conn)


df.to_csv('reduced_SaF.csv', index=False)


conn.close()


print(df.head())
